### Fri 23 Oct, 2015

## О проекте
Удобный online сервис для поиска и бронирования большого спектра услуг обслуживания авто от различных автосервисов.
Отличительная особенность сервиса - realtime streaming с камеры хода работа и последующего просмотра.

### Риски
- Зависимость от автосервисов и их сотрудничества с нами
- Возможны конкуренты, разрабатывающие схожий продукт

### Предположения
- Скорее всего для каждого автосервиса необходима будет custom-ная интеграция с их существующей системой (как минимум импорт базовых данных в нашу систему),
как максимум отдельная интеграция их ПО с нашим сервисов и обратно, что может быть затратно. 

В случае такой необходимости (и с учетом того, что 99% случаев ПО автосервисов будет работать на Windows) имеет смысл использовать компилируемый современный С подобный язык - Go.

## Первоначальная архитектура и технологии

Фокус в первую очередь на fast time to market, т.е. чем быстрее будет готов работающий прототип, тем лучше. Это отчасти определяет выбор технологий и подходов в разработке.

Проект должен соответствовать http://12factor.net/. В связи с этим за основу будет взята microservices архитектура, на данном этапе будет один основной компонент, 
в будущем возможно разбиение на подкомпоненты. Все взаимодействие между компонентами и с внешним миром 100% посредством API. Т.о. frontend будет представлять собой SPA (возможно AngularJS или React).

В качестве возможного шлюза для доступа к API можно будет использовать https://getkong.org/.

### HTTP server
nginx

### RESTful web services framework
DropWizard (выбран из-за простоты, хорошей документации, наличии базовых модулей, и расширяемости при необходимости, 60 issues в github по сравнению с 434 у Spring Boot, интеграции с http://metrics.dropwizard.io/3.1.0/).
Рассматриваемые альтернативы: Spring Boot
Возможные риски: если сравнивать с количеством доступных модулей для Spring Boot - то да, возможно что-то придется писать самим. Поддержка Jetty 9.3+ появится только в версии 1.0, выход которой пока неизвестен.
Opinionated convention over configuration - что может быть как плюсом, так и минусом - т.е. меньше возможностей (по сравнению со Spring Boot) для перенастройки framework-а, но опять же это может быть даже плюс.

### Application web server
Embedded Jetty 9.2+
Рассматриваемые альтернативы: а их в принципе и нет, поскольку это единственный возможный вариант, который допускает DropWizard. К слову Spring Boot поддерживает Jetty, Tomcat и Undertow.
Возможные риски: минимальны. Jetty - production ready application web server, передовой в плане доступности web технологий, используется в production многими компаниями, в т.ч. в банковской сфере. Поддерживает WebSocket-ы. 
Интеграция Jetty WebSocket-ов и DropWizard осуществляется легко (проверено на практике).

### Build tool
Gradle (выбран одновременно из-за простоты, и возможностей, которые предоставляет при необходимости, Gradle makes the impossible possible, the possible easy and the easy elegant. 
Gradle является основным языком для сборки Android проектов. Да и в целом build - как программа, хорошая идея)
Рассматриваемые альтернативы: maven
Возможные риски: возможен некий начальный барьер в течении изучения и знакомства с Gradle

### Testing framework
Spock Framework (выбран из-за простоты, data driven testing, Groovy, современный testing framework - использует современные подходы и идеи)
Рассматриваемые альтернативы: JUnit, TestNG
Возможные риски: возможен некий начальный барьер в течении изучения и знакомства с Groovy

### Provisioning & Deployment
Docker containers (выбран из-за простоты, возможности deployment-а на любой cloud hosting, современный подход, гибкость, изоляция, и т.д., вообще классная штука). Возможно в сочетании с https://www.tutum.co/ или отдельно.
Рассматриваемые альтернативы: Puppet, Vagrant (может быть что-нибудь из них и будет смысл использовать отдельно, посмотрим).
Возможные риски: возможен некий начальный барьер в течении изучения и знакомства с технологией. "Родная" для Linux, для Windows и Mac - в связи с необходимостью использовать виртуальную машину (решается посредством Docker Machine), может быть чуть менее удобна в работе по сравнению с Linux-ом, но учитывая кол-во разработчиков с Apple ноутбуками, этот риск минимален.

### Hosting
На начальном этапе Digital Ocean (выбран из-за простоты, прозрачной цена - 5$ в месяц, 2 первых месяца, скорее всего бесплатны, инновациям). В production - возможно также Digital Ocean только более дорогой (20$-80$ в месяц instance).
Рассматриваемые варианты: AWS (если честно, не знаю, какая месячная стоимость одного instance-а, предоставляет большее кол-во сервисов, возможны отдельные сервисы мы будем использовать так или иначе), компьютер Сергея :)
Возможные риски: минимальны, так как Docker containers позволяют поменять cloud hosting фактически за минуты, или даже использовать различные cloud provider-ы одновременно.

### Database
PostgreSQL (выбрана из-за простоты, отличной документации, хорошей поддержки в Open Source, наличию разнообразных возможностей) с обязательным data replication. Данные приложения хорошо ложатся в relational model.
Рассматриваемые альтернативы: среди relational db - никаких. Среди NoSQL - например, Mongo или Cassandra, но они нам сейчас не нужны, нам еще нужно дорасти до того кол-ва пользователей, чтобы использовать Mongo или Cassandra.
Возможные риски: если проект "выстрелит" возможно в один день придется мигрировать в NoSQL (что прекрасно :)

### Persistence framework
JDBI (не путать с JDBC) - да пишем чистый SQL. Предпочтение отдается Fluent API. Возможна интеграция с jOOQ (но только в качестве SQL Builder). Выбран из-за простоты, прозрачности запросов, прямая работа с данными из базы данных, родная поддержка в DropWizard.
Рассматриваемые альтернативы: вне ORM решений - никаких. ORM решения, такие как Hibernate, не рассматривались принципиально. Под вопросом использование Spring Data, скорее нет, чем да. Посмотрим.
Возможные риски: нужно изучать SQL. Риск написания в итоге своего ORM решения, нужно быть аккуратным.

### Кеширование/in-memory store (в случае необходимости)
Redis

